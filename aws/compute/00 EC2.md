- IaaS
- EC2 stores data on virtual drives called EBS volumes
- we can distribute load across machines using ELB (Elastic Load Balancer)
- we can scale the service using ASG (Auto Scaling Groups)
###### important ports to remember
- SSH - 22
- FTP - 21
- SFTP - 22
- HTTP - 80
- HTTPS - 443
- RDP - 3389
## Sizing and configuration options
- Linux, Windows or Mac OS
- CPU cores
- RAM
- Storage space
	- can be attached over network with EBS or EFS
	- can be attached hardware (EC2 Instance Store)
	- there is an option to delete storage volume on termination of EBS, if you want the data to be persistent turn that to false
![[Pasted image 20251116220647.png]]
- network card
	- decides the speed of the card
	- public IP
- Auto assigns public IP to make sure we are able to SSH to it
	- when we stop and start an instance again, it assigns a new IP to it
	- the private IP doesnt change
- the ssh key pairs can be reused across EC2 instances
#### security groups
- only contain allow rules
- the rules can be based on IP addresses or pull from other security groups
- firewall
- regulate access to ports
- regulate authorized IP ranges from the internet
- Security groups are **stateful**, meaning if you allow an inbound request from a source, the response traffic is automatically allowed back out, regardless of outbound rules. The same applies in reverse for outbound connections.
- a security group can be attached to multiple EC2 isntance
- an EC2 instance can have multiple security groups too
- security groups are attached to regions/VPCs
	- so if we move regions or create new VPC we will need to create new security groups
- usually best practice to have one security group just for SSH access
- by default all outbound is authorised and all inbound is blocked
- in Security Group we need to allow ssh from Anywhere
	- it also needs to be on a public subnet
	- we can do that when creating the EC2 isntance
![[Pasted image 20251116215853.png]]
- if we want to launch a web server on the EC2 instance then we should also allow http traffic
##### referencing Security groups from other security groups
used for interservice communication
lets say we have 2 EC2 instances A and B, B has security group S attached to it
in A's security group we can refer B's security group and then B can communicate with A through a port decided in A's security group
![[Pasted image 20251117234524.png]]
The rule goes in the destination's security group

**Example scenario:**
- Instance A runs a database (port 3306)
- Instance B runs an application server
- In A's inbound rules: Allow port 3306 from Security Group SB
- Now B can connect to A's database, and any other instance with SB attached can too
#### bootstrap script
- we can provide a bootstrap script that is run at the time of launch of VM (EC2 User Data)
	- the boot strap script is run as the root user
	- the option to upload a script or write is there in the UI under advanced details
![[Pasted image 20251116221010.png]]

if we make our EC2 private we wont even be able to update our packages

if we need a way to reach out to the internet but not allow access to EC2
we can do that with a NAT gateway (Network Address Translation)

the NAT gateway must be created in the public subnet
and a route entry must be created in the public route table to point to the NAT gateway
going from 0.0.0.0/0 to the nat gateway 
### EC2 instance types
different types are optimzied for different use cases
https://aws.amazon.com/ec2/instance-types/
choose the one that matches your use case
instance types follow a naming convention well
- m5.2xlarge
where "m" is the instance class and in this case its the general purpose type of EC2
"5" is the generation of the instance, amazon updates and patches and what not
the "2xlarge" is the size of the instance within the instance class

1. General purpose - 
	1. good for webservers
	2. good balance between compute memory and networking
2. Compute optimized- 
	1. good for batch processing workloads, and media processing units, HPC, ML, gaming servers
	2. naming convention has them named as c...
3. Memory optimized
	1. good for data processing for in memory workloads, in memory redis instances
	2. distributed cache,
	3. naming convention says they start with R.., C.., Z...
4. storage optimized
	1. good when do a lot of read and write to storage, like relational databases, and order book serves
	2. typically named as I.., D.., H..

## SSHing to EC2

- use the .pem file that you downloaded when creating the EC2
- use the public ip of the EC2
- the security group should have the port 22 rule enabled

> chmod 0400 server.pem
> ssh -i server.pem ec2-user@public-ip 

we can also connect to EC2 using EC2 instance connect which is available on AWS
- select the EC2 instance you want to connect to and then click connect on top

